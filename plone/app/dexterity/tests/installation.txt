Integration with Plone product installation
===========================================

Make sure we have hidden our field/widget dependencies from the quick
installer.  (Although, Plone trunk doesn't use the quick installer, so
then we'll just skip the check.)
  >>> portal = layer['portal']
  >>> products = [p['id'] for p in portal.portal_quickinstaller.listInstallableProducts(skipInstalled=False)]
  >>> 'plone.app.dexterity' in products
  True
  >>> 'plone.formwidget.autocomplete' in products
  False
  >>> 'plone.formwidget.contenttree' in products
  False

Get a logged-in test browser.
  >>> from plone.testing.z2 import setRoles
  >>> layer['app'].acl_users.userFolderAddUser('admin', 'secret', ['Manager'], [])
  >>> import transaction; transaction.commit()
  >>> from plone.testing.z2 import Browser
  >>> browser = Browser(layer['app'])
  >>> browser.addHeader('Authorization', 'Basic admin:secret')

Load the form for creating a new Plone site and make sure we see the
expected profiles.
  >>> browser.open('http://nohost/@@plone-addsite')
  >>> 'plone.app.dexterity:default' in browser.contents
  True
  >>> 'plone.formwidget.autocomplete:default' in browser.contents
  False
  >>> 'plone.formwidget.contenttree:default' in browser.contents
  False
